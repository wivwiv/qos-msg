import{_ as q}from"./Monaco.vue_vue_type_style_index_0_lang-C5FqW0sc.js";import{d as I,q as M,g as i,C as P,c as k,a as b,b as o,w as u,b0 as U,p as $,u as t,y as E,l as z,r as d,V as A,o as _,F as G,k as J,aH as K,aA as W,aB as X,m as Y,f as Z}from"./index-Dp_94g6t.js";import{q as ee}from"./diagnose-CTW0WGD4.js";import{u as oe}from"./usePagination-CGGmJjfQ.js";import"./http-DdqGSA6b.js";const te={class:"log-view"},le={class:"search-wrapper"},ne=["element-loading-text"],ae=I({__name:"LogView",setup(se){const{t:v}=M("LogTrace"),y=i(),g=i(300),r=i(""),f=i(0),p=i(!1),w=i(""),{page:h,limit:L,count:C}=oe();L.value=100;const c=i({content_like:"",module:void 0}),B=()=>{var l,n;const s=(((n=(l=y.value)==null?void 0:l.getBoundingClientRect())==null?void 0:n.top)||250)+30,e=window.innerHeight;g.value=e-s},x=async()=>{p.value=!0,r.value="",w.value="",await V(),p.value=!1},H=async s=>{const{scrollTop:e,scrollHeight:l,scrollTopChanged:n}=s;e+g.value>=l&&n&&f.value<C.value&&(p.value=!0,w.value=v("LogTrace.loadNextPage"),h.value++,await V(),p.value=!1)},V=async()=>{const s={page:h.value,limit:L.value,...Object.fromEntries(Object.entries(c.value).filter(([,e])=>!!e))};try{const{meta:e,contents:l}=await ee(s);f.value+=l.length,r.value+=l.join(`
`),C.value=e.count}catch{}},m=()=>{r.value="",f.value=0,h.value=1,C.value=0,V()},T=()=>{c.value.content_like="",c.value.module=void 0,m()};return P(()=>{B(),x()}),(s,e)=>{const l=d("el-input"),n=d("el-col"),S=d("el-option"),O=d("el-select"),Q=W,D=X,F=d("el-row"),N=d("el-form"),R=q,j=A("loading");return _(),k("div",te,[b("div",le,[o(N,{inline:!0,onSubmit:U(m,["prevent"])},{default:u(()=>[o(F,{gutter:20},{default:u(()=>[o(n,{span:6},{default:u(()=>[o(l,{modelValue:t(c).content_like,"onUpdate:modelValue":e[0]||(e[0]=a=>t(c).content_like=a),clearable:"",placeholder:t(v)("QoS.logContent"),onClear:m},null,8,["modelValue","placeholder"])]),_:1}),o(n,{span:6},{default:u(()=>[o(O,{modelValue:t(c).module,"onUpdate:modelValue":e[1]||(e[1]=a=>t(c).module=a),clearable:"",placeholder:t(v)("QoS.logModule"),onClear:m},{default:u(()=>[(_(!0),k(G,null,J("QoSOptions"in s?s.QoSOptions:t(K),a=>(_(),Y(S,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),o(n,{span:6}),o(n,{span:6,class:"col-oper"},{default:u(()=>[o(Q,{onClick:m}),o(D,{onClick:T})]),_:1})]),_:1})]),_:1})]),$((_(),k("div",{class:"app-wrapper","element-loading-text":t(w)},[b("div",{style:z({height:t(g)+"px"}),class:"viewer-container",ref_key:"monacoContainer",ref:y},[o(R,{id:"log-trace",modelValue:t(r),"onUpdate:modelValue":e[2]||(e[2]=a=>E(r)?r.value=a:null),"scroll-loading":!0,"scroll-func":H,lang:"powershell",disabled:!0},null,8,["modelValue"])],4)],8,ne)),[[j,t(p)]])])}}}),pe=Z(ae,[["__scopeId","data-v-0c882586"]]);export{pe as default};
