import{a5 as q,cC as x,M as R,c7 as I,bm as j,aD as y,aQ as K,cD as d,cE as W,cF as F,H as w,G as L,cz as G,b9 as H}from"./index-gzDiX6cq.js";const z={BAD_USERNAME_OR_PWD:"BAD_USERNAME_OR_PWD",BAD_MFA_TOKEN:"BAD_MFA_TOKEN",LOGIN_LOCKED:"LOGIN_LOCKED"},ie={none:"none",disabled:"disabled",totp:"totp"},$="BAD_TOKEN",Q="TOKEN_TIME_OUT",{LOGIN_LOCKED:V}=z,J="BAD_USERNAME_OR_PWD",Y="BAD_MFA_TOKEN",X=25,Z=e=>{const i=Number((e.length/X).toFixed(3))*1e3;return i<3e3?3e3:i>8e3?8e3:i},U=e=>!e||R.isString(e)||R.isFunction(e)?{message:e}:e,T=e=>{const{message:i,duration:r,showClose:o,type:p}=U(e),u=r||i&&Z(i)||void 0;return q({...e,duration:u,showClose:o||p==="error"})};x.forEach(e=>{T[e]=(i={})=>{const r=U(i);return T({...r,type:e})}});var k={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(e,i){(function(r,o){e.exports=o()})(I,function(){var r={};r.version="0.2.0";var o=r.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};r.configure=function(t){var n,s;for(n in t)s=t[n],s!==void 0&&t.hasOwnProperty(n)&&(o[n]=s);return this},r.status=null,r.set=function(t){var n=r.isStarted();t=p(t,o.minimum,1),r.status=t===1?null:t;var s=r.render(!n),c=s.querySelector(o.barSelector),l=o.speed,E=o.easing;return s.offsetWidth,O(function(a){o.positionUsing===""&&(o.positionUsing=r.getPositioningCSS()),v(c,g(t,l,E)),t===1?(v(s,{transition:"none",opacity:1}),s.offsetWidth,setTimeout(function(){v(s,{transition:"all "+l+"ms linear",opacity:0}),setTimeout(function(){r.remove(),a()},l)},l)):setTimeout(a,l)}),this},r.isStarted=function(){return typeof r.status=="number"},r.start=function(){r.status||r.set(0);var t=function(){setTimeout(function(){r.status&&(r.trickle(),t())},o.trickleSpeed)};return o.trickle&&t(),this},r.done=function(t){return!t&&!r.status?this:r.inc(.3+.5*Math.random()).set(1)},r.inc=function(t){var n=r.status;return n?(typeof t!="number"&&(t=(1-n)*p(Math.random()*n,.1,.95)),n=p(n+t,0,.994),r.set(n)):r.start()},r.trickle=function(){return r.inc(Math.random()*o.trickleRate)},function(){var t=0,n=0;r.promise=function(s){return!s||s.state()==="resolved"?this:(n===0&&r.start(),t++,n++,s.always(function(){n--,n===0?(t=0,r.done()):r.set((t-n)/t)}),this)}}(),r.render=function(t){if(r.isRendered())return document.getElementById("nprogress");P(document.documentElement,"nprogress-busy");var n=document.createElement("div");n.id="nprogress",n.innerHTML=o.template;var s=n.querySelector(o.barSelector),c=t?"-100":u(r.status||0),l=document.querySelector(o.parent),E;return v(s,{transition:"all 0 linear",transform:"translate3d("+c+"%,0,0)"}),o.showSpinner||(E=n.querySelector(o.spinnerSelector),E&&D(E)),l!=document.body&&P(l,"nprogress-custom-parent"),l.appendChild(n),n},r.remove=function(){A(document.documentElement,"nprogress-busy"),A(document.querySelector(o.parent),"nprogress-custom-parent");var t=document.getElementById("nprogress");t&&D(t)},r.isRendered=function(){return!!document.getElementById("nprogress")},r.getPositioningCSS=function(){var t=document.body.style,n="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return n+"Perspective"in t?"translate3d":n+"Transform"in t?"translate":"margin"};function p(t,n,s){return t<n?n:t>s?s:t}function u(t){return(-1+t)*100}function g(t,n,s){var c;return o.positionUsing==="translate3d"?c={transform:"translate3d("+u(t)+"%,0,0)"}:o.positionUsing==="translate"?c={transform:"translate("+u(t)+"%,0)"}:c={"margin-left":u(t)+"%"},c.transition="all "+n+"ms "+s,c}var O=function(){var t=[];function n(){var s=t.shift();s&&s(n)}return function(s){t.push(s),t.length==1&&n()}}(),v=function(){var t=["Webkit","O","Moz","ms"],n={};function s(a){return a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(f,m){return m.toUpperCase()})}function c(a){var f=document.body.style;if(a in f)return a;for(var m=t.length,S=a.charAt(0).toUpperCase()+a.slice(1),_;m--;)if(_=t[m]+S,_ in f)return _;return a}function l(a){return a=s(a),n[a]||(n[a]=c(a))}function E(a,f,m){f=l(f),a.style[f]=m}return function(a,f){var m=arguments,S,_;if(m.length==2)for(S in f)_=f[S],_!==void 0&&f.hasOwnProperty(S)&&E(a,S,_);else E(a,m[1],m[2])}}();function C(t,n){var s=typeof t=="string"?t:b(t);return s.indexOf(" "+n+" ")>=0}function P(t,n){var s=b(t),c=s+n;C(s,n)||(t.className=c.substring(1))}function A(t,n){var s=b(t),c;C(t,n)&&(c=s.replace(" "+n+" "," "),t.className=c.substring(1,c.length-1))}function b(t){return(" "+(t.className||"")+" ").replace(/\s+/gi," ")}function D(t){t&&t.parentNode&&t.parentNode.removeChild(t)}return r})})(k);var ee=k.exports;const N=j(ee);N.configure({showSpinner:!1,trickleSpeed:200});let h=new Set;const M=()=>h=new Set;Object.assign(y.defaults,{baseURL:K,timeout:2e4});y.interceptors.request.use(e=>{const{user:i}=d.state;e.headers.Authorization="Bearer "+i.token;const r=new AbortController;return e.signal=r.signal,e.controller=r,d.commit("ADD_ABORT_CONTROLLER",r),!e.keepSpaces&&e.method&&["post","put"].includes(e.method)&&R.isPlainObject(e.data)&&(e.data=W(e.data)),e},e=>Promise.reject(e));y.interceptors.request.use(async e=>(e.doNotTriggerProgress||(d.state.request_queue||N.start(),await d.dispatch("SET_REQ_CHANGE",!0)),e));const te=(e,i)=>e===401&&[$,Q].includes(i.code),re=async e=>{try{const i=await e.text();return JSON.parse(i)}catch{return{}}},ne=(e,i)=>{if(!e)return`${i} Network error`;if(typeof e!="object")return`${i}: ${e.toString()}`;const{code:r,message:o}=e;if(r||o){const p=o?typeof o=="object"?JSON.stringify(o):o.toString():"";return`${i} ${r??""}: ${p}`}return`${i}: ${H(e)}`},se=[Y,V];y.interceptors.response.use(e=>{var r;if((r=e==null?void 0:e.config)!=null&&r.doNotTriggerProgress||B(),e.data instanceof Blob)return e;const i=e.config.controller;return d.commit("REMOVE_ABORT_CONTROLLER",i),e.data||e.status},async e=>{var o,p;(o=e==null?void 0:e.config)!=null&&o.doNotTriggerProgress||B();const i=F.global.t;if(e.response){e.response.data instanceof Blob&&(e.response.data=await re(e.response.data));const{data:u,status:g}=e.response;if(!h.has(g)){h.add(g);const O=g===401&&d.state.afterCurrentUserPwdChanged;if(te(g,u))return O?d.commit("SET_AFTER_CURRENT_USER_PWD_CHANGED",!1):w.error(i("Base.tokenExpiredMsg")),L(),window.setTimeout(M,1e3),Promise.reject(e);((p=e.config)==null?void 0:p.errorsHandleCustom)&&Array.isArray(e.config.errorsHandleCustom)&&e.config.errorsHandleCustom.includes(g)||(u.code===J?w.error(i("Base.namePwdError")):se.includes(u.code)||T.error(ne(u,g))),g===401&&L()}}else{const u=e.code===G&&e.config.handleTimeoutSelf;if(e.code==="ERR_CANCELED"&&e.message==="canceled")return Promise.reject(e);h.has(0)||(u||T.error(i("Base.networkError")),h.add(0))}d.state.request_queue===0&&(h=new Set),R.throttle(M,2e3,{trailing:!1});const r=e.config.controller;return d.commit("REMOVE_ABORT_CONTROLLER",r),Promise.reject(e)});async function B(){await d.dispatch("SET_REQ_CHANGE",!1),d.state.request_queue>0?N.inc():N.done()}export{ie as D,V as L,Y as M};
