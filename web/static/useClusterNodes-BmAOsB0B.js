import{k as y,m as g}from"./common-ctHvRRmR.js";import{g as a,A as N,M as h}from"./index-F6_Zcexc.js";import{c as M}from"./compareVersions-DqEOhma6.js";function x({loadByDefault:m,hideProgress:f,timeout:V,getVersion:d}={loadByDefault:!0,getVersion:!1}){const t=a([]),r=a(!1),i=a(!0),e=N({latestVersion:"",isMutiVersion:!1}),l=a(""),v=s=>{const p=s.map(o=>o.version.split("-")[0]),n=h.uniq(p);e.isMutiVersion=n.length>1,e.isMutiVersion?e.latestVersion=n.reduce((o,c)=>M(c,o)>0?c:o):e.latestVersion=n[0],e.latestVersion=`v${e.latestVersion}`},u=async()=>{try{r.value=!0,t.value=await y(f,V)??[],i.value=t.value.some(s=>![0,"0"].includes(s.memory_total)),d&&v(t.value)}catch{}finally{r.value=!1}};return m&&u(),(async()=>{const s=await g();l.value=s.name??""})(),{nodes:t,lockTable:r,hasMemory:i,loadData:u,versionInfo:e,clusterName:l}}export{x as u};
