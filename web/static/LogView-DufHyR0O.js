import{_ as P}from"./Monaco.vue_vue_type_style_index_0_lang-D8U6C2xl.js";import{d as Q,q as A,g as c,C as D,c as L,a as V,b as o,w as u,K as F,b1 as j,p as q,u as t,y as $,l as Y,r as d,V as z,o as S,F as W,k as Z,aA as G,aB as J,f as X}from"./index-gzDiX6cq.js";import{q as ee}from"./diagnose-DSIpHM3s.js";import{u as oe}from"./usePagination-BCZH5bCc.js";import"./http-BlFWNHJL.js";const te={class:"log-view"},le={class:"search-wrapper"},ne=["element-loading-text"],ae=Q({__name:"LogView",setup(se){const{t:m}=A("LogTrace"),T=c(),v=c(300),i=c(""),g=c(0),p=c(!1),f=c(""),{page:w,limit:y,count:h}=oe();y.value=100;const s=c({content_like:"",module:void 0}),U=["PUBLISH","SUBSCRIBE","UNSUBSCRIBE","API","MQTT","WS-MQTT","SOCKET","CLI","QUERY","RULE","AUTHZ","MULTI_TENANCY","CUSTOM"],k=()=>{var l,n;const r=(((n=(l=T.value)==null?void 0:l.getBoundingClientRect())==null?void 0:n.top)||250)+30,e=window.innerHeight;v.value=e-r},b=async()=>{p.value=!0,i.value="",f.value="",await C(),p.value=!1},x=async r=>{const{scrollTop:e,scrollHeight:l,scrollTopChanged:n}=r;e+v.value>=l&&n&&g.value<h.value&&(p.value=!0,f.value=m("LogTrace.loadNextPage"),w.value++,await C(),p.value=!1)},C=async()=>{const r={page:w.value,limit:y.value,...Object.fromEntries(Object.entries(s.value).filter(([,e])=>!!e))};try{const{meta:e,contents:l}=await ee(r);g.value+=l.length,i.value+=l.join(`
`),h.value=e.count}catch{}},_=()=>{i.value="",g.value=0,w.value=1,h.value=0,C()},I=()=>{s.value.content_like="",s.value.module=void 0,_()};return D(()=>{k(),b()}),(r,e)=>{const l=d("el-input"),n=d("el-col"),B=d("el-option"),E=d("el-select"),R=G,H=J,M=d("el-row"),N=d("el-form"),K=P,O=z("loading");return S(),L("div",te,[V("div",le,[o(N,{inline:!0,onKeyup:F(j(_,["prevent"]),["enter"])},{default:u(()=>[o(M,{gutter:20},{default:u(()=>[o(n,{span:6},{default:u(()=>[o(l,{modelValue:t(s).content_like,"onUpdate:modelValue":e[0]||(e[0]=a=>t(s).content_like=a),clearable:"",placeholder:t(m)("QoS.logContent"),onClear:_},null,8,["modelValue","placeholder"])]),_:1}),o(n,{span:6},{default:u(()=>[o(E,{modelValue:t(s).module,"onUpdate:modelValue":e[1]||(e[1]=a=>t(s).module=a),clearable:"",placeholder:t(m)("QoS.logModule"),onClear:_},{default:u(()=>[(S(),L(W,null,Z(U,a=>o(B,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1}),o(n,{span:6}),o(n,{span:6,class:"col-oper"},{default:u(()=>[o(R,{onClick:_}),o(H,{onClick:I})]),_:1})]),_:1})]),_:1},8,["onKeyup"])]),q((S(),L("div",{class:"app-wrapper","element-loading-text":t(f)},[V("div",{style:Y({height:t(v)+"px"}),class:"viewer-container",ref_key:"monacoContainer",ref:T},[o(K,{id:"log-trace",modelValue:t(i),"onUpdate:modelValue":e[2]||(e[2]=a=>$(i)?i.value=a:null),"scroll-loading":!0,"scroll-func":x,lang:"powershell",disabled:!0},null,8,["modelValue"])],4)],8,ne)),[[O,t(p)]])])}}}),pe=X(ae,[["__scopeId","data-v-53a516b6"]]);export{pe as default};
