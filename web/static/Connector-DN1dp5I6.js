import{d as ee,g as p,q as te,c as R,a as s,b as o,p as ne,u as t,m as I,w as l,y as k,F as oe,aM as ae,r as _,V as le,s as se,o as C,n as ce,x as S,t as v,e as E,b7 as ie,bn as w,aI as re}from"./index-F6_Zcexc.js";import{_ as U,a as de}from"./TableItemDropDown.vue_vue_type_script_setup_true_lang-BfLEX2Xg.js";import{a as ue}from"./TargetItemStatus.vue_vue_type_style_index_0_lang-CQnxMjT0.js";import{_ as me}from"./CreateRuleWithConnector.vue_vue_type_style_index_0_lang-D89utF8r.js";import{_ as pe,a as _e}from"./DisableConnectorConfirm.vue_vue_type_style_index_0_lang-DS2UdF3C.js";import{g as be,e as fe,u as ge}from"./useDataHandler-Dj1fwDX7.js";import{a as Ce,f as ve}from"./useBridgeTypeValue-CwFoz3CA.js";import"./copy-document-CyachSYR.js";import"./CheckIcon.vue_vue_type_style_index_0_lang-DeVbzpy2.js";import"./check-R5MM5VH5.js";import"./close-C-gDC1-1.js";import"./useActionAndSourceStatus-BuifRkTw.js";import"./success-filled-BOzrBrbt.js";import"./http-BI9UuFDl.js";import"./useOperationConfirm-DKx22PW7.js";const ye=()=>({getConnectorList:async()=>{try{const i=await be();return Promise.resolve(i)}catch(i){return Promise.reject(i)}}}),he={class:"connectors"},Ve={class:"app-wrapper"},$e={class:"section-header"},ke={class:"tooltip-content"},Be=["src"],De={class:"name-type-block"},Ne={class:"name-data"},Te={class:"type-data"},Le={class:"tooltip-content"},He=ee({__name:"Connector",setup(M){const i=se(),y=p(!1),h=p([]),r=p(new Map),{t:b,tl:c}=te("RuleEngine"),{getConnectorList:P}=ye(),d=async()=>{try{y.value=!0,h.value=await P(),W()}catch{}finally{y.value=!1}},W=()=>{r.value=new Map,h.value.forEach(({id:n})=>r.value.set(n,!1))},j=({status:n})=>n===w.Disconnected||n===w.Inconsistent,{handleDeleteConnector:q,reconnectConnector:F,showDisableConfirm:V,currentConnector:B,handleToggleConnectorEnable:O,showDelTip:$}=fe(),{judgeIsWebhookConnector:f}=ge(),x=async({id:n})=>{try{r.value.set(n,!0),await F(n),d()}catch{}finally{r.value.set(n,!1)}},D=({id:n})=>({name:"connector-detail",params:{id:n}}),z=async n=>{try{await O(n,d)}catch{}},g=p(!1),N=p(void 0),H=async n=>{g.value=!0,N.value=n},K=({id:n})=>{i.push({name:"connector-create",query:{action:"copy",target:n}})},{getBridgeIcon:A}=Ce(),{getTypeStr:G}=ve();return d(),(n,a)=>{const J=ae,Q=_("router-link"),T=_("el-tooltip"),u=_("el-table-column"),X=_("el-switch"),L=re,Y=_("el-table"),Z=le("loading");return C(),R(oe,null,[s("div",he,[s("div",Ve,[s("div",$e,[a[4]||(a[4]=s("div",null,null,-1)),o(J,{onClick:a[0]||(a[0]=e=>n.$router.push({name:"connector-create"}))})]),ne((C(),I(Y,{data:t(h),ref:"TableCom","row-key":"id"},{default:l(()=>[o(u,{label:t(c)("name"),"min-width":120},{default:l(({row:e})=>[o(T,{class:"box-item",effect:"dark",placement:"top",disabled:!e.canNotView,content:t(c)("canNotViewConnectorTip")},{default:l(()=>[s("div",ke,[o(Q,{to:e.canNotView?"":D(e),class:ce(["first-column-with-icon-type link-detail",{"is-disabled":e.canNotView}])},{default:l(()=>[e.type?(C(),R("img",{key:0,class:"icon-type",src:t(A)(e.type)},null,8,Be)):S("",!0),s("div",De,[s("span",Ne,v(e.name),1),s("span",Te,v(t(G)(e.type)),1)])]),_:2},1032,["to","class"])])]),_:2},1032,["disabled","content"])]),_:1},8,["label"]),o(u,{label:t(c)("connectionStatus")},{default:l(({row:e})=>[o(ue,{type:"connector",target:e},null,8,["target"])]),_:1},8,["label"]),o(u,{prop:"enable",label:n.$t("Base.isEnabled"),"min-width":92},{default:l(({row:e})=>[o(U,{disabled:!t(f)(e),name:e.name,operation:`${t(b)("Base.enable")}${t(c)("or")}${t(b)("Base.disable")}`,targetLabel:t(c)("action")},{default:l(()=>[o(X,{"model-value":e.enable,disabled:t(f)(e),"onUpdate:modelValue":m=>z(e)},null,8,["model-value","disabled","onUpdate:modelValue"])]),_:2},1032,["disabled","name","operation","targetLabel"])]),_:1},8,["label"]),o(u,{prop:"description",label:t(b)("BridgeSchema.common.description.label"),"min-width":108},null,8,["label"]),o(u,{label:n.$t("Base.operation"),"min-width":168},{default:l(({row:e})=>[o(T,{class:"box-item",effect:"dark",placement:"top-start",disabled:!e.canNotView,content:t(c)("canNotViewConnectorTip")},{default:l(()=>[s("div",Le,[j(e)?(C(),I(L,{key:0,disabled:!n.$hasPermission("post")||e.canNotView,loading:t(r).get(e.id),onClick:m=>x(e)},{default:l(()=>[E(v(n.$t("RuleEngine.reconnect")),1)]),_:2},1032,["disabled","loading","onClick"])):S("",!0),o(L,{disabled:e.canNotView,onClick:m=>n.$router.push(D(e))},{default:l(()=>[E(v(n.$t("Base.setting")),1)]),_:2},1032,["disabled","onClick"]),o(U,{disabled:!t(f)(e),name:e.name,operation:t(c)("moreOperation"),targetLabel:t(b)("components.connector")},{default:l(()=>[o(de,{"can-create-rule":e.type!==t(ie).SysKeeperProxy,"row-data":e,disabled:e.canNotView||t(f)(e),onCopy:m=>K(e),onCreateRule:m=>H(e),onDelete:m=>t(q)(e,d)},null,8,["can-create-rule","row-data","disabled","onCopy","onCreateRule","onDelete"])]),_:2},1032,["disabled","name","operation","targetLabel"])])]),_:2},1032,["disabled","content"])]),_:1},8,["label"])]),_:1},8,["data"])),[[Z,t(y),void 0,{lock:!0}]])]),o(me,{modelValue:t(g),"onUpdate:modelValue":a[1]||(a[1]=e=>k(g)?g.value=e:null),connector:t(N)},null,8,["modelValue","connector"])]),o(pe,{modelValue:t($),"onUpdate:modelValue":a[2]||(a[2]=e=>k($)?$.value=e:null),connector:t(B)},null,8,["modelValue","connector"]),o(_e,{modelValue:t(V),"onUpdate:modelValue":a[3]||(a[3]=e=>k(V)?V.value=e:null),connector:t(B),onSubmitted:d},null,8,["modelValue","connector"])],64)}}});export{He as default};
