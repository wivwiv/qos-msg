import{_ as S}from"./InfoTooltip-CPsvXzu1.js";import{_ as V,d as h,o as c,c as v,a as t,g as A,z,b as s,w as i,u as n,p as E,m as B,y as L,E as I,a5 as R,r as b,V as j,e as f,t as r,F as q,k as O,x as U,aw as k}from"./index-F6_Zcexc.js";import{l as W,i as x}from"./common-ctHvRRmR.js";import{_ as G}from"./commonPagination.vue_vue_type_style_index_0_lang-DgIFxPZ3.js";import{u as J}from"./usePaginationWithHasNext-DUeJLYsI.js";import{u as K}from"./useDurationStr-B_hM76H_.js";import"./http-BI9UuFDl.js";const Q=h({name:"Remove"}),X={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Y=t("path",{fill:"currentColor",d:"M352 480h320a32 32 0 1 1 0 64H352a32 32 0 0 1 0-64z"},null,-1),Z=t("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),aa=[Y,Z];function ea(w,u,m,d,p,$){return c(),v("svg",X,aa)}var ta=V(Q,[["render",ea]]);const la={class:"alarm app-wrapper"},oa={class:"section-header"},sa={class:"message-with-icon"},na={class:"emq-table-footer"},ra=h({name:"currentAlarm"}),fa=h({...ra,setup(w){const u=A(!1),m=A([]),{t:d}=z(),{pageMeta:p,pageParams:$,initPageMeta:C,setPageMeta:D}=J(),{transMsNumToSimpleStr:M}=K(),g=async(a={})=>{u.value=!0;const l={...$.value,...a};try{const{data:_,meta:o}=await W(!0,l);m.value=_,D(o)}catch{m.value=[],C()}finally{u.value=!1}},N=async()=>{try{await I.confirm(d("Alarm.clearConfirm"),{confirmButtonText:d("Base.confirm"),cancelButtonText:d("Base.cancel"),confirmButtonClass:"confirm-danger",type:"warning"}),await x().catch(()=>{})&&(R.success(d("Alarm.clearSuccess")),g())}catch(a){console.error(a)}};return g(),(a,l)=>{const _=b("el-button"),o=b("el-table-column"),F=S,P=b("el-table"),T=j("loading");return c(),v("div",la,[t("div",oa,[l[1]||(l[1]=t("div",null,null,-1)),t("div",null,[s(_,{type:"danger",plain:"",icon:n(ta),onClick:N,disabled:!n(m).length||!a.$hasPermission("delete")},{default:i(()=>[f(r(a.$t("Alarm.clearHistory")),1)]),_:1},8,["icon","disabled"])])]),E((c(),B(P,{data:n(m)},{default:i(()=>[s(o,{prop:"name",label:a.$t("Alarm.alarmName")},null,8,["label"]),s(o,{label:a.$t("Alarm.alarmMsg")},{default:i(({row:e})=>[t("div",sa,[Object.keys(e.details).length?(c(),B(F,{key:0},{content:i(()=>[(c(!0),v(q,null,O(e.details,(H,y)=>(c(),v("div",{key:y},r(y)+": "+r(H),1))),128))]),_:2},1024)):U("",!0),t("span",null,r(e.message),1)])]),_:1},8,["label"]),s(o,{prop:"node",label:a.$t("Alarm.triggerNode")},null,8,["label"]),s(o,{label:a.$t("Alarm.alarmLevel")},{default:i(()=>[t("span",null,r(a.$t("Alarm.system")),1)]),_:1},8,["label"]),s(o,{prop:"activate_at",label:a.$t("Alarm.activateTime")},{default:i(({row:e})=>[f(r(e.activate_at&&("dateFormat"in a?a.dateFormat:n(k))(e.activate_at)),1),l[2]||(l[2]=t("br",null,null,-1)),f(" "+r(e.deactivate_at&&("dateFormat"in a?a.dateFormat:n(k))(e.deactivate_at)),1)]),_:1},8,["label"]),s(o,{prop:"deactivate_at",label:a.$t("Alarm.duration")},{default:i(({row:e})=>[f(r(n(M)(e.duration)),1)]),_:1},8,["label"])]),_:1},8,["data"])),[[T,n(u),void 0,{lock:!0}]]),t("div",na,[s(G,{metaData:n(p),"onUpdate:metaData":l[0]||(l[0]=e=>L(p)?p.value=e:null),onLoadPage:g},null,8,["metaData"])])])}}});export{fa as default};
