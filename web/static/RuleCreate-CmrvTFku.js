import{_ as D}from"./DetailHeader.vue_vue_type_style_index_0_lang-B2doPzV1.js";import{b as S,a as k,c as q}from"./useRule-DGtnoBQH.js";import{u as E,a as N,_ as x}from"./useRuleForm-C3euPOGL.js";import{d,z as B,g as s,M as i,c as I,b as l,w as $,aV as F,r as M,i as z,s as A,o as L,u as m,y as T,a5 as U}from"./index-Dp_94g6t.js";import{u as j}from"./useDataNotSaveConfirm-CX0RqJFS.js";import"./arrow-left-B1ek5uAF.js";import"./useBridgeTypeValue-BhHkY53V.js";import"./http-DdqGSA6b.js";import"./Monaco.vue_vue_type_style_index_0_lang-C5FqW0sc.js";import"./InfoTooltip-CtXDYqOe.js";import"./UsingSchemaBridgeConfig.vue_vue_type_script_setup_true_lang-l4E03JUu.js";import"./SchemaForm-BkipX-KD.js";import"./CertFileInput.vue_vue_type_script_setup_true_lang-TvYTJUaZ.js";import"./FormItemLabel.vue_vue_type_style_index_0_lang-COEYw7jn.js";import"./MarkdownContent.vue_vue_type_style_index_0_lang-oyE4YyGM.js";import"./arrow-right-CfKClDRJ.js";import"./useCopy-xLykWTHO.js";import"./useDataHandler-URbL20R0.js";import"./useOperationConfirm-DftZFsPf.js";import"./check-NEZYo7gf.js";import"./CreateRuleWithConnector.vue_vue_type_style_index_0_lang-yHBJwdXb.js";import"./success-filled-HwXygNV2.js";import"./CommonOverflowTooltip.vue_vue_type_style_index_0_lang-qVzbqlOC.js";import"./KeyAndValueEditor.vue_vue_type_style_index_0_lang-BS3yU87G.js";import"./useDocLink-Ksjh4w9I.js";import"./useFormRules-Dd-VLxGD.js";import"./setting-9MIiA4cd.js";import"./compareVersions-DqEOhma6.js";import"./CheckIcon.vue_vue_type_style_index_0_lang-BuOFsLdJ.js";import"./close-ebScOGTJ.js";import"./useHandleActionItem-CKafnUW3.js";import"./TextEasyCopy.vue_vue_type_style_index_0_lang-DjH3of4s.js";import"./TargetItemStatus.vue_vue_type_style_index_0_lang-BdF3sX6E.js";import"./useActionAndSourceStatus-D5aIU2c4.js";import"./pie-Bag65DYr.js";import"./useSyncPolling-EuuWKCYU.js";import"./more-filled-oO2Y30cN.js";import"./useHandleSourceItem-BuhTrh1O.js";import"./useDeleteBridge-DCqjwvF-.js";import"./usePaginationRemember-BBiMlW9V.js";import"./useCheckBeforeSaveAsCopy-BPwheWzh.js";import"./SourceDetail-CNWN3-U7.js";import"./CodeView.vue_vue_type_style_index_0_lang-COVY_D_l.js";import"./copy-document-DOc9hYqD.js";import"./diagnose-CTW0WGD4.js";import"./circle-close-filled-D3EWRYs9.js";const G={class:"rule-create app-wrapper"},H=d({name:"RuleCreate"}),Ae=d({...H,setup(J){const{t:f}=B(),o=z(),v=A(),r=s(!1),{createRawRuleForm:_}=E(),e=s(_());let u=i.cloneDeep(e.value);const R=()=>!i.isEqual(e.value,u);let p=!1;const{isTesting:C,savedAfterDataChange:n,updateSavedData:g}=N(e);n.value=!1;const c=s();j(R);const y=async()=>{if(o.query.action==="copy"&&o.query.target){const t=await S(o.query.target),a=i.pick(t,["sql","actions","description","actions"]);a&&(e.value={...a,id:F(t.id)})}},b=async()=>{await c.value.validate(),r.value=!0;try{await(p?k(e.value.id,{...e.value}):q({...e.value})),u=e.value,U.success(f("Base.createSuccess")),p=!0,C.value?g(e.value):v.push({name:"rule"})}catch{}finally{r.value=!1}};return y(),(t,a)=>{const w=D,h=M("el-card");return L(),I("div",G,[l(w,{item:{name:t.$t("RuleEngine.createRule"),routeName:"rule"}},null,8,["item"]),l(h,{class:"rule-form-card overview-visible app-card"},{default:$(()=>[l(x,{ref_key:"formCom",ref:c,modelValue:m(e),"onUpdate:modelValue":a[0]||(a[0]=V=>T(e)?e.value=V:null),"submit-loading":m(r),"name-disabled":m(n),onSave:b},null,8,["modelValue","submit-loading","name-disabled"])]),_:1})])}}});export{Ae as default};
