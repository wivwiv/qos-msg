import"./http-DdqGSA6b.js";import{aD as n,g as t,A as S,j as f,aP as c,X as o,aQ as L}from"./index-Dp_94g6t.js";function h(){return n.get("/users")}function v(e){return n.post("/users",e)}function R(e,s,a){return n.put(`/users/${encodeURIComponent(e)}`,s,a?{params:{backend:a}}:void 0)}function I(e,s){return n.post(`/users/${encodeURIComponent(e)}/change_pwd`,s)}function w(e,s){return n.delete(`/users/${encodeURIComponent(e)}`,s?{params:{backend:s}}:void 0)}function y(e,s){return n.post(`/users/${encodeURIComponent(e)}/mfa`,s)}function C(e){return n.delete(`/users/${encodeURIComponent(e)}/mfa`)}const U=(e,s)=>n.post(`/sso/login/${e}`,s),b=()=>n.get("/sso/running"),P=()=>{const e=new Map([[o.ldap,"LDAP"],[o.saml,"SAML 2.0"],[o.oidc,"OIDC"]]);return{getBackendLabel:a=>e.get(a)||""}};function A(){const e=t([]),s=t(!1),a=S({username:"",password:"",backend:"ldap"}),d=t("local"),u=`${c}/sso/login/${o.saml}`,l=t(L.saml),i=`${c}/sso/login/${o.oidc}`,p=t(o.oidc),g=f(()=>e.value.length>0);return{currentLoginBackend:d,samlLoginUrl:u,samlBackend:l,oidcLoginUrl:i,oidcBackend:p,isSSOLoading:s,enabledSSOList:e,ldapRecord:a,hasSSOEnabled:g,ldapLogin:async()=>{try{s.value=!0;const r=await U("ldap",a),{username:m}=a;return Promise.resolve({username:m,response:r})}catch(r){return Promise.reject(r)}finally{s.value=!1}},getEnabledSSO:async()=>{try{e.value=await b()}catch{}}}}export{y as a,P as b,I as c,C as d,R as e,v as f,w as g,h as l,A as u};
