import{_ as S}from"./DetailHeader.vue_vue_type_style_index_0_lang-jMoftCB_.js";import{b as V,a as k,c as q}from"./useRule-XWlG7MOW.js";import{u as E,a as N,_ as x}from"./useRuleForm-DJxIDq8q.js";import{d,z as B,g as s,M as i,c as I,b as l,w as $,aW as F,r as M,i as z,s as A,o as L,u as m,y as T,a5 as U}from"./index-gzDiX6cq.js";import{u as W}from"./useDataNotSaveConfirm-HuE7DjIs.js";import"./arrow-left-CB0GLQev.js";import"./useBridgeTypeValue-DfFvHZxE.js";import"./http-BlFWNHJL.js";import"./Monaco.vue_vue_type_style_index_0_lang-D8U6C2xl.js";import"./InfoTooltip-DsMY02kq.js";import"./UsingSchemaBridgeConfig.vue_vue_type_script_setup_true_lang-C7IqXt86.js";import"./SchemaForm-B5Ct9r7g.js";import"./CertFileInput.vue_vue_type_script_setup_true_lang-DHqscjx4.js";import"./FormItemLabel.vue_vue_type_style_index_0_lang-C2ue8b3P.js";import"./MarkdownContent.vue_vue_type_style_index_0_lang-CvIt_HhB.js";import"./arrow-right-K2qPT6rh.js";import"./useCopy-zlCfhwDY.js";import"./useDataHandler-DIoGjH2Q.js";import"./useOperationConfirm-SEd6OnAP.js";import"./check-AciMBS21.js";import"./CreateRuleWithConnector.vue_vue_type_style_index_0_lang-DzkuCXLT.js";import"./success-filled-CFwVfEFi.js";import"./CommonOverflowTooltip.vue_vue_type_style_index_0_lang-Du1TBZn7.js";import"./KeyAndValueEditor.vue_vue_type_style_index_0_lang--Tqi0AAK.js";import"./useDocLink-DK-uFujS.js";import"./useFormRules-BXbR-dxB.js";import"./setting-Bk0ROr2k.js";import"./compareVersions-DqEOhma6.js";import"./CheckIcon.vue_vue_type_style_index_0_lang-CwdT__iB.js";import"./close-DHQqAhpS.js";import"./useHandleActionItem-CLBwxXaF.js";import"./TextEasyCopy.vue_vue_type_style_index_0_lang-WBOKfnFy.js";import"./TargetItemStatus.vue_vue_type_style_index_0_lang-Bi-597rW.js";import"./useActionAndSourceStatus-gzXOZG2c.js";import"./pie-BnP3p4-0.js";import"./useSyncPolling-15pkvvIZ.js";import"./more-filled-DdhB6Svi.js";import"./useHandleSourceItem-C2NmvGoR.js";import"./useDeleteBridge-CmOHUvjU.js";import"./usePaginationRemember-n4ryuqdx.js";import"./useCheckBeforeSaveAsCopy-6rpqkkHP.js";import"./SourceDetail-BinG0Xfs.js";import"./CodeView.vue_vue_type_style_index_0_lang-DGZ1vVQX.js";import"./copy-document-BB3y9vIn.js";import"./diagnose-DSIpHM3s.js";import"./circle-close-filled-C93ARdYO.js";const j={class:"rule-create app-wrapper"},G=d({name:"RuleCreate"}),Ae=d({...G,setup(H){const{t:f}=B(),o=z(),v=A(),r=s(!1),{createRawRuleForm:_}=E(),e=s(_());let u=i.cloneDeep(e.value);const R=()=>!i.isEqual(e.value,u);let p=!1;const{isTesting:C,savedAfterDataChange:n,updateSavedData:g}=N(e);n.value=!1;const c=s();W(R);const y=async()=>{if(o.query.action==="copy"&&o.query.target){const t=await V(o.query.target),a=i.pick(t,["sql","actions","description","actions"]);a&&(e.value={...a,id:F(t.id)})}},b=async()=>{await c.value.validate(),r.value=!0;try{await(p?k(e.value.id,{...e.value}):q({...e.value})),u=e.value,U.success(f("Base.createSuccess")),p=!0,C.value?g(e.value):v.push({name:"rule"})}catch{}finally{r.value=!1}};return y(),(t,a)=>{const w=S,h=M("el-card");return L(),I("div",j,[l(w,{item:{name:t.$t("RuleEngine.createRule"),routeName:"rule"}},null,8,["item"]),l(h,{class:"rule-form-card overview-visible app-card"},{default:$(()=>[l(x,{ref_key:"formCom",ref:c,modelValue:m(e),"onUpdate:modelValue":a[0]||(a[0]=D=>T(e)?e.value=D:null),"submit-loading":m(r),"name-disabled":m(n),onSave:b},null,8,["modelValue","submit-loading","name-disabled"])]),_:1})])}}});export{Ae as default};
