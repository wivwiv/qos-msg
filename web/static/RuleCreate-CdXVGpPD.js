import{_ as S}from"./DetailHeader.vue_vue_type_style_index_0_lang-MGYnd5rE.js";import{b as V,a as k,c as q}from"./useRule-BMAMsE-E.js";import{u as E,a as N,_ as x}from"./useRuleForm-EVyYm6Gb.js";import{d,z as B,g as s,M as i,c as I,b as l,w as $,aW as F,r as M,i as z,s as A,o as L,u as m,y as T,a5 as U}from"./index-F6_Zcexc.js";import{u as W}from"./useDataNotSaveConfirm-BCKJs-mK.js";import"./arrow-left-C6KBoFkH.js";import"./useBridgeTypeValue-CwFoz3CA.js";import"./http-BI9UuFDl.js";import"./Monaco.vue_vue_type_style_index_0_lang-m8fKnWUe.js";import"./InfoTooltip-CPsvXzu1.js";import"./UsingSchemaBridgeConfig.vue_vue_type_script_setup_true_lang-CfvG3dh8.js";import"./SchemaForm-B_Fg3rxO.js";import"./CertFileInput.vue_vue_type_script_setup_true_lang-Ca-vV8wZ.js";import"./FormItemLabel.vue_vue_type_style_index_0_lang-Ck9-NCDQ.js";import"./MarkdownContent.vue_vue_type_style_index_0_lang-D3IVIbCc.js";import"./arrow-right-CF1KQuyr.js";import"./useCopy-DSWu-SkJ.js";import"./useDataHandler-Dj1fwDX7.js";import"./useOperationConfirm-DKx22PW7.js";import"./check-R5MM5VH5.js";import"./CreateRuleWithConnector.vue_vue_type_style_index_0_lang-D89utF8r.js";import"./success-filled-BOzrBrbt.js";import"./CommonOverflowTooltip.vue_vue_type_style_index_0_lang-Bl9D7zI6.js";import"./KeyAndValueEditor.vue_vue_type_style_index_0_lang-D3W6EXAW.js";import"./useDocLink-ffxcUtfC.js";import"./useFormRules-BfOwVzOl.js";import"./setting-C_yJtbRY.js";import"./compareVersions-DqEOhma6.js";import"./CheckIcon.vue_vue_type_style_index_0_lang-DeVbzpy2.js";import"./close-C-gDC1-1.js";import"./useHandleActionItem-mdEFjGCq.js";import"./TextEasyCopy.vue_vue_type_style_index_0_lang-DcuKy8ig.js";import"./TargetItemStatus.vue_vue_type_style_index_0_lang-CQnxMjT0.js";import"./useActionAndSourceStatus-BuifRkTw.js";import"./pie-CYSv_nPN.js";import"./useSyncPolling-Cdzdb31s.js";import"./more-filled-0yBCXu6I.js";import"./useHandleSourceItem-DfyO6jzu.js";import"./useDeleteBridge-BoVzcnQO.js";import"./usePaginationRemember-D5rHcBsI.js";import"./useCheckBeforeSaveAsCopy-G-vwB4_N.js";import"./SourceDetail-L1e0WVIS.js";import"./CodeView.vue_vue_type_style_index_0_lang-DfS_eEVT.js";import"./copy-document-CyachSYR.js";import"./diagnose-7MmtxX9Z.js";import"./circle-close-filled-D3sJFt05.js";const j={class:"rule-create app-wrapper"},G=d({name:"RuleCreate"}),Ae=d({...G,setup(H){const{t:f}=B(),o=z(),v=A(),r=s(!1),{createRawRuleForm:_}=E(),e=s(_());let u=i.cloneDeep(e.value);const R=()=>!i.isEqual(e.value,u);let p=!1;const{isTesting:C,savedAfterDataChange:n,updateSavedData:g}=N(e);n.value=!1;const c=s();W(R);const y=async()=>{if(o.query.action==="copy"&&o.query.target){const t=await V(o.query.target),a=i.pick(t,["sql","actions","description","actions"]);a&&(e.value={...a,id:F(t.id)})}},b=async()=>{await c.value.validate(),r.value=!0;try{await(p?k(e.value.id,{...e.value}):q({...e.value})),u=e.value,U.success(f("Base.createSuccess")),p=!0,C.value?g(e.value):v.push({name:"rule"})}catch{}finally{r.value=!1}};return y(),(t,a)=>{const w=S,h=M("el-card");return L(),I("div",j,[l(w,{item:{name:t.$t("RuleEngine.createRule"),routeName:"rule"}},null,8,["item"]),l(h,{class:"rule-form-card overview-visible app-card"},{default:$(()=>[l(x,{ref_key:"formCom",ref:c,modelValue:m(e),"onUpdate:modelValue":a[0]||(a[0]=D=>T(e)?e.value=D:null),"submit-loading":m(r),"name-disabled":m(n),onSave:b},null,8,["modelValue","submit-loading","name-disabled"])]),_:1})])}}});export{Ae as default};
