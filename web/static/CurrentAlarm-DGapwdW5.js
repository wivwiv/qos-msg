import{_ as B}from"./InfoTooltip-DsMY02kq.js";import{d as h,q as C,g,c as v,a as o,b as t,p as b,u as i,m as F,w as n,y as L,av as M,r as A,V,h as E,o as d,F as R,k as q,t as r,e as I,aw as U,v as H}from"./index-gzDiX6cq.js";import{l as O}from"./common-D7Kj9vwB.js";import{_ as W}from"./commonPagination.vue_vue_type_style_index_0_lang-2B_sFQsX.js";import{u as j}from"./usePaginationWithHasNext-CYBMwbz-.js";import{u as z}from"./useDurationStr-CGOrOjoa.js";import"./http-BlFWNHJL.js";const G={class:"alarm app-wrapper"},J={class:"section-header"},K={class:"message-with-icon"},Q={class:"emq-table-footer"},X=h({name:"currentAlarm"}),oa=h({...X,setup(Y){C("Alarm");const p=g(!1),m=g([]),$=E(),{pageMeta:c,pageParams:D,initPageMeta:k,setPageMeta:N}=j(),{transMsNumToSimpleStr:T}=z(),_=async(a={})=>{p.value=!0;const l={...D.value,...a};try{const{data:u,meta:s}=await O(!1,l);m.value=u,$.dispatch("SET_ALERT_COUNT",m.value.length||0),N(s)}catch{m.value=[],k()}finally{p.value=!1}};return _(),(a,l)=>{const u=M,s=A("el-table-column"),y=B,P=A("el-table"),S=V("loading");return d(),v("div",G,[o("div",J,[l[2]||(l[2]=o("div",null,null,-1)),t(u,{disabled:!a.$hasPermission("get"),onClick:l[0]||(l[0]=e=>_({page:1}))},null,8,["disabled"])]),b((d(),F(P,{data:i(m)},{default:n(()=>[t(s,{prop:"name",label:a.$t("Alarm.alarmName")},null,8,["label"]),t(s,{prop:"message",label:a.$t("Alarm.alarmMsg")},{default:n(({row:e})=>[o("div",K,[t(y,null,{content:n(()=>[(d(!0),v(R,null,q(e.details,(w,f)=>(d(),v("div",{key:f},r(f)+": "+r(w),1))),128))]),_:2},1024),o("span",null,r(e.message),1)])]),_:1},8,["label"]),t(s,{prop:"node",label:a.$t("Alarm.triggerNode")},null,8,["label"]),t(s,{label:a.$t("Alarm.alarmLevel")},{default:n(()=>[o("span",null,r(a.$t("Alarm.system")),1)]),_:1},8,["label"]),t(s,{prop:"activate_at",label:a.$t("Alarm.activateAt")},{default:n(({row:e})=>[I(r(e.activate_at&&("dateFormat"in a?a.dateFormat:i(U))(e.activate_at)||""),1)]),_:1},8,["label"]),t(s,null,{header:n(()=>[o("span",null,r(a.$t("Alarm.duration")),1)]),default:n(({row:e})=>[b(o("span",null,r(i(T)(e.duration)),513),[[H,e.duration]])]),_:1})]),_:1},8,["data"])),[[S,i(p),void 0,{lock:!0}]]),o("div",Q,[t(W,{metaData:i(c),"onUpdate:metaData":l[1]||(l[1]=e=>L(c)?c.value=e:null),onLoadPage:_},null,8,["metaData"])])])}}});export{oa as default};
