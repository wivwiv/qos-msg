import{_ as ye}from"./DetailHeader.vue_vue_type_style_index_0_lang-B2doPzV1.js";import{_ as be}from"./CommonOverflowTooltip.vue_vue_type_style_index_0_lang-qVzbqlOC.js";import{d as Ce,j as i,q as he,g as _,c as we,a as l,u as e,m as p,w as n,x as g,p as ke,n as Ve,b as a,y as V,F as Te,r as c,V as De,i as Be,s as $e,o as u,e as v,t as m,M as Ee,R as Re,W as Fe,aY as E,a5 as P}from"./index-Dp_94g6t.js";import{u as Ie,a as Se,f as We,_ as Ne}from"./useBridgeTypeValue-BhHkY53V.js";import{_ as Ue}from"./CopySubmitDialog.vue_vue_type_script_setup_true_lang-rduYiXFR.js";import{a as Ae}from"./TargetItemStatus.vue_vue_type_style_index_0_lang-BdF3sX6E.js";import{_ as Pe,a as je}from"./DisableConnectorConfirm.vue_vue_type_style_index_0_lang-BfQeyR1c.js";import{j as Oe}from"./SchemaForm-BkipX-KD.js";import{e as He,u as Le,f as Me}from"./useDataHandler-URbL20R0.js";import{u as qe}from"./useOperationConfirm-DftZFsPf.js";import{u as xe}from"./useCheckBeforeSaveAsCopy-BPwheWzh.js";import"./arrow-left-B1ek5uAF.js";import"./useRule-DGtnoBQH.js";import"./http-DdqGSA6b.js";import"./CreateRuleWithConnector.vue_vue_type_style_index_0_lang-yHBJwdXb.js";import"./success-filled-HwXygNV2.js";import"./useHandleActionItem-CKafnUW3.js";import"./CheckIcon.vue_vue_type_style_index_0_lang-BuOFsLdJ.js";import"./check-NEZYo7gf.js";import"./close-ebScOGTJ.js";import"./useActionAndSourceStatus-D5aIU2c4.js";import"./CertFileInput.vue_vue_type_script_setup_true_lang-TvYTJUaZ.js";import"./InfoTooltip-CtXDYqOe.js";import"./FormItemLabel.vue_vue_type_style_index_0_lang-COEYw7jn.js";import"./MarkdownContent.vue_vue_type_style_index_0_lang-oyE4YyGM.js";import"./arrow-right-CfKClDRJ.js";import"./useCopy-xLykWTHO.js";import"./Monaco.vue_vue_type_style_index_0_lang-C5FqW0sc.js";import"./KeyAndValueEditor.vue_vue_type_style_index_0_lang-BS3yU87G.js";import"./useDocLink-Ksjh4w9I.js";import"./useFormRules-Dd-VLxGD.js";import"./setting-9MIiA4cd.js";import"./compareVersions-DqEOhma6.js";const ze={class:"connector-detail bridge-detail"},Ge={class:"detail-top"},Ye={class:"vertical-align-center"},Je=["src"],Ke={class:"block-title"},Qe={class:"form-container"},Xe={class:"btn-area"},Wo=Ce({__name:"ConnectorDetail",props:{connectorId:{}},setup(j){const O=j,R=Be(),H=$e(),f=i(()=>["rule-detail","rule-create"].includes(R.name)),{t:y,tl:b}=he("RuleEngine"),T=i(()=>f.value?O.connectorId:R.params.id),{getBridgeGeneralType:L}=Ie(),F=i(()=>{const t=T.value.slice(0,T.value.indexOf(":"));return L(t)}),C=_(),{formCom:M}=Oe(F),o=_({}),h=_(!1),I=_({}),q=i(()=>({type:"connector",obj:I.value})),S=i(()=>o.value.name),{getBridgeIcon:x}=Se(),{getTypeStr:z}=We(),{getConnectorDetail:G,updateConnector:Y,showDisableConfirm:D,currentConnector:J,handleToggleConnectorEnable:K,isTesting:Q,testConnectivity:X,handleDeleteConnector:Z,showDelTip:B}=He(),{judgeIsWebhookConnector:ee}=Le(),d=i(()=>ee(o.value)),oe=i(()=>d.value?{formProps:{disabled:!0}}:{}),te=i(()=>({})),w=_(!1);(async()=>{try{w.value=!0,o.value=await G(T.value)}catch{}finally{w.value=!1}})();const{operationWarning:ne}=qe(),ae=async()=>{try{await E(C.value),await X(o.value),P.success(b("connectionSuccessful"))}catch{}},se=()=>{K(o.value,W)},W=()=>{o.value.enable=!o.value.enable},{handleConnectorDataForSaveAsCopy:le}=Me(),{pwdErrorWhenCoping:N,checkLikePwdField:re}=xe(),ie=async()=>{try{await E(C.value),await re(o.value),I.value=le(o.value),h.value=!0}catch{}},$=_(!1),ce=async()=>{try{await E(C.value),await ne(b("updateConnectorTip")),$.value=!0;const t=await Y(o.value);return f.value||(P.success(y("Base.updateSuccess")),H.push({name:"connector"})),Promise.resolve(t.id)}catch{}finally{$.value=!1}};return(t,s)=>{const ue=be,de=c("el-tag"),pe=c("el-switch"),U=c("el-tooltip"),k=c("el-button"),me=ye,A=c("el-alert"),_e=c("router-link"),fe=c("i18n-t"),ge=c("el-card"),ve=De("loading");return u(),we(Te,null,[l("div",ze,[l("div",Ge,[e(f)?g("",!0):(u(),p(me,{key:0,item:{name:e(S),routeName:"connector"}},{content:n(()=>[l("div",Ye,[l("img",{src:e(x)(e(o).type)},null,8,Je),l("div",Ke,[a(ue,{content:e(S)},null,8,["content"])]),a(Ae,{type:"connector",target:e(o),"is-tag":""},null,8,["target"]),a(de,{type:"info",class:"section-status"},{default:n(()=>[v(m(e(z)(e(o).type)),1)]),_:1})])]),extra:n(()=>[a(U,{content:e(o).enable?t.$t("Base.disable"):t.$t("Base.enable"),placement:"top"},{default:n(()=>[a(pe,{class:"enable-btn","model-value":e(o).enable,disabled:e(d),"onUpdate:modelValue":se},null,8,["model-value","disabled"])]),_:1},8,["content"]),a(U,{content:t.$t("Base.delete"),placement:"top"},{default:n(()=>[a(k,{class:"icon-button",type:"danger",icon:e(Ne),disabled:e(d),onClick:s[0]||(s[0]=r=>e(Z)(e(o),()=>{t.$router.push({name:"connector"})})),plain:""},null,8,["icon","disabled"])]),_:1},8,["content"])]),_:1},8,["item"])),l("div",null,[e(N)?(u(),p(A,{key:0,title:e(N),type:"error"},null,8,["title"])):g("",!0),ke((u(),p(ge,{class:Ve(["app-card",e(f)&&"app-inline-card"]),shadow:e(f)?"never":void 0},{default:n(()=>[e(d)?(u(),p(A,{key:0,class:"webhook-tip-alert","show-icon":"",type:"info",closable:!1},{default:n(()=>[a(fe,{keypath:"RuleEngine.handleWebhookAssociatedTip",tag:"p",scope:"global"},{target:n(()=>[l("span",null,m(e(y)("components.connector")),1)]),operation:n(()=>[l("span",null,m(("lowerCase"in t?t.lowerCase:e(Ee.lowerCase))(e(y)("Base.edit"))),1)]),page:n(()=>[a(_e,{to:e(te)},{default:n(()=>[v("Webhook "+m(e(y)("RuleEngine.page")),1)]),_:1},8,["to"])]),_:1})]),_:1})):g("",!0),l("div",Qe,[(u(),p(Re(e(M)),Fe({ref_key:"FormCom",ref:C,class:"bridge-config",modelValue:e(o),"onUpdate:modelValue":s[1]||(s[1]=r=>V(o)?o.value=r:null),type:e(F),"is-loading":e(w),disabled:e(d),edit:""},e(oe)),null,16,["modelValue","type","is-loading","disabled"]))]),l("div",Xe,[a(k,{onClick:ie,disabled:e(d)},{default:n(()=>[v(m(e(b)("saveAsCopy")),1)]),_:1},8,["disabled"]),e(o).type?(u(),p(k,{key:0,type:"primary",plain:"",loading:e(Q),onClick:ae},{default:n(()=>[v(m(e(b)("testTheConnection")),1)]),_:1},8,["loading"])):g("",!0),e(o).type?(u(),p(k,{key:1,type:"primary",loading:e($),disabled:e(d),onClick:ce},{default:n(()=>[v(m(t.$t("Base.update")),1)]),_:1},8,["loading","disabled"])):g("",!0)])]),_:1},8,["class","shadow"])),[[ve,e(w)]])])])]),a(Ue,{modelValue:e(h),"onUpdate:modelValue":s[2]||(s[2]=r=>V(h)?h.value=r:null),target:e(q)},null,8,["modelValue","target"]),a(Pe,{modelValue:e(B),"onUpdate:modelValue":s[3]||(s[3]=r=>V(B)?B.value=r:null),connector:e(o)},null,8,["modelValue","connector"]),a(je,{modelValue:e(D),"onUpdate:modelValue":s[4]||(s[4]=r=>V(D)?D.value=r:null),connector:e(J),onSubmitted:W},null,8,["modelValue","connector"])],64)}}});export{Wo as default};
