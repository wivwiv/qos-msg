import{d as B,q as O,g as _,c as W,b as e,w as o,K as j,a as p,p as z,u as l,m as w,y as T,r as s,V as G,s as J,o as d,e as $,t as y,aA as Q,aB as X,aw as Y,aI as Z}from"./index-Dp_94g6t.js";import{_ as ee}from"./CommonOverflowTooltip.vue_vue_type_style_index_0_lang-qVzbqlOC.js";import{m as te}from"./common-7tZUksOK.js";import{_ as oe}from"./commonPagination.vue_vue_type_style_index_0_lang-KnR7msZT.js";import{u as ae}from"./usePaginationWithHasNext-BJFMDxOM.js";import"./http-DdqGSA6b.js";const ne={class:"topics"},le={class:"app-wrapper"},se={class:"section-header"},ce={class:"emq-table-footer"},ie=B({name:"Topics"}),be=B({...ie,setup(pe){const V=J(),{tl:m}=O("Subs"),f=_([]),c=_(""),v=_(!0),b=_({}),{pageMeta:h,pageParams:D,initPageMeta:P,setPageMeta:M}=ae(),g=()=>{const t=c.value.trim();b.value.topic=t,i({page:1})},R=()=>{c.value="",b.value={},i({page:1})},i=async(t={})=>{v.value=!0;const a={...b.value,...D.value,...t};try{const{data:r=[],meta:u={}}=await te(a);f.value=r,M(u)}catch{f.value=[],P()}finally{v.value=!1}},N=/\/(#|\+)/,S=t=>!N.test(t),q=t=>{V.push({name:"topic-metrics",query:{topic:t}})};return i(),(t,a)=>{const r=s("el-input"),u=s("el-col"),K=Q,I=X,U=s("el-row"),x=s("el-form"),A=Y,E=ee,k=s("el-table-column"),C=Z,F=s("el-tooltip"),H=s("el-table"),L=G("loading");return d(),W("div",ne,[e(x,{class:"search-wrapper without-padding-top",onKeyup:j(g,["enter"])},{default:o(()=>[e(U,{gutter:28},{default:o(()=>[e(u,{span:8},{default:o(()=>[e(r,{modelValue:l(c),"onUpdate:modelValue":a[0]||(a[0]=n=>T(c)?c.value=n:null),placeholder:t.$t("Topics.topic"),clearable:"",onClear:g},null,8,["modelValue","placeholder"])]),_:1}),e(u,{span:8},{default:o(()=>[e(K,{onClick:g}),e(I,{onClick:R})]),_:1})]),_:1})]),_:1}),p("div",le,[p("div",se,[a[2]||(a[2]=p("div",null,null,-1)),e(A,{onClick:i})]),z((d(),w(H,{data:l(f)},{default:o(()=>[e(k,{prop:"topic",label:t.$t("Topics.topic")},{default:o(({row:n})=>[e(E,{content:n.topic},null,8,["content"])]),_:1},8,["label"]),e(k,{prop:"node",label:t.$t("Clients.node")},null,8,["label"]),e(k,{label:t.$t("Base.operation")},{default:o(({row:n})=>[S(n.topic)?(d(),w(C,{key:1,disabled:!t.$hasPermission("post"),onClick:re=>q(n.topic)},{default:o(()=>[$(y(l(m)("addMetric")),1)]),_:2},1032,["disabled","onClick"])):(d(),w(F,{key:0,class:"box-item",effect:"dark",content:l(m)("wildcardNotSupport")},{default:o(()=>[p("span",null,[e(C,{disabled:""},{default:o(()=>[$(y(l(m)("addMetric")),1)]),_:1})])]),_:1},8,["content"]))]),_:1},8,["label"])]),_:1},8,["data"])),[[L,l(v),void 0,{lock:!0}]]),p("div",ce,[e(oe,{metaData:l(h),"onUpdate:metaData":a[1]||(a[1]=n=>T(h)?h.value=n:null),onLoadPage:i},null,8,["metaData"])])])])}}});export{be as default};
